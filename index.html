<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Anonymous Voting System</title>

    <!-- ê¸°ë³¸ ìŠ¤íƒ€ì¼ -->
    <link rel="stylesheet" href="style.css" />

    <!-- vis-network (ì£¼ì œ ì§€ë„) -->
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>

    <!-- Chart.js (í†µê³„ ê·¸ë˜í”„) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <h2>Anonymous Voting System</h2>

    <!-- ================== íˆ¬í‘œ ìƒì„± ================== -->
    <div id="create-poll-section">
        <h3>ğŸ“ ìƒˆ íˆ¬í‘œ ë§Œë“¤ê¸°</h3>

        <form id="create-poll-form">
            <input
                type="text"
                id="poll-question"
                placeholder="ì§ˆë¬¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”."
                required
            />

            <div style="margin: 10px 0 5px; font-size: 14px; font-weight: bold;">
                ì¶”ì²œ íƒœê·¸:
            </div>

            <div
                id="recommended-tags-container"
                style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 10px;"
            ></div>

            <input
                type="text"
                id="poll-tags"
                placeholder="íƒœê·¸ ì…ë ¥ (ì¶”ì²œ íƒœê·¸ í´ë¦­ ë˜ëŠ” ì§ì ‘ ì…ë ¥)"
                required
            />

            <button type="submit">íˆ¬í‘œ ìƒì„±</button>
        </form>
    </div>

    <hr />

    <!-- ================== ì£¼ì œ ê·¸ë˜í”„ ================== -->
    <div id="graph-section">
        <h3>ğŸ” íˆ¬í‘œ ì£¼ì œì§€ë„</h3>
        <p style="font-size: 13px; color: gray;">
            ì£¼ì œë¥¼ í´ë¦­í•˜ë©´ ê´€ë ¨ íˆ¬í‘œë§Œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>

        <div id="network"></div>

        <button id="reset-filter-btn" class="graph-btn">
            ğŸ”„ ì „ì²´ ëª©ë¡ ë‹¤ì‹œ ë³´ê¸°
        </button>
    </div>

    <hr />

    <!-- ================== í†µê³„ ê·¸ë˜í”„ ================== -->
    <div id="chart-section" style="display: none;">
        <h3>ğŸ“Š íˆ¬í‘œ ê²°ê³¼ í†µê³„</h3>

        <select id="chart-type-selector">
            <option value="bar">ë§‰ëŒ€ ê·¸ë˜í”„</option>
            <option value="pie">ì›í˜• ê·¸ë˜í”„</option>
            <option value="doughnut">ë„ë„› ê·¸ë˜í”„</option>
            <option value="line">ë¼ì¸ ê·¸ë˜í”„</option>
        </select>

        <div style="height: 400px; margin-top: 10px;">
            <canvas id="voteChart"></canvas>
        </div>
    </div>

    <hr />

    <!-- ================== íˆ¬í‘œ ëª©ë¡ ================== -->
    <h3>ğŸ—³ï¸ ì§„í–‰ ì¤‘ì¸ íˆ¬í‘œë“¤</h3>
    <div id="polls" class="scroll-list_wrp"></div>

    <!-- ================== JS Modules ================== -->
    <script type="module">
        import "./vote_form.js";
        import "./graph.js";
        import "./chartView.js";
        import { initAuth, loadPoll } from "./pollData.js";

        async function main() {
            try {
                await initAuth();
                await loadPoll();
            } catch (e) {
                console.error("ì´ˆê¸°í™” ì‹¤íŒ¨:", e);
                document.getElementById("polls").innerText =
                    "ì•±ì„ ë¡œë”©í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
            }
        }

        main();
    </script>
</body>
</html>
