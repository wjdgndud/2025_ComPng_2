<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anonymous Voting System</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
</head>
<body>
    <h2>Anonymous Voting System</h2>

    <div id="create-poll-section">
        <h3>📝 새 투표 만들기</h3>
        
        <form id="create-poll-form">
            <label for="poll-question" style="font-weight:bold; display:block; margin-bottom:5px;">질문</label>
            <input type="text" id="poll-question" placeholder="질문 내용을 입력하세요." required>
            
            <div style="margin-top: 20px;">
                <div style="margin-bottom: 8px; font-size: 14px; font-weight: bold;">추천 태그</div>
                
                <div id="recommended-tags-container"></div>
                <!-- 추천 태그 버튼들이 여기에 동적으로 추가 -->

                <input type="text" id="poll-tags" placeholder="태그 입력 (위 버튼을 클릭하거나 직접 입력)" required>
            </div>

            <div style="font-size: 13px; color: #555; background-color: #f8f9fa; padding: 12px; border-radius: 6px; border: 1px solid #eee; margin-top: 5px;">
                <strong>💡 태그 작성 가이드</strong>
                <ul style="margin: 5px 0 0 20px; padding: 0;">
                    <li><strong>자동 분류:</strong> 가장 많이 쓰인 태그가 그룹 색상이 됩니다.</li>
                    <li><strong>작성 팁:</strong> 큰 범위를 앞에 적어주세요. (예: IT, 개발, 연봉)</li>
                </ul>
            </div>

            <button type="submit">투표 생성</button>
        </form>
    </div>
    
    <hr>

    <div id="graph-section">
        <h3>🔎 투표 주제지도</h3>
        <p style="font-size: 13px; color: gray; margin-top: -10px;">주제를 클릭하면 관련 투표만 볼 수 있습니다.</p>
        
        <div id="network">
            <!-- 그래프가 여기에 렌더링 -->
            </div>
        
        <button id="reset-filter-btn" class="graph-btn">🔄 전체 목록 다시 보기</button>
    </div>
    
    <hr>

    <h3>🗳️ 진행 중인 투표들</h3>
    <div id="polls" class="scroll-list_wrp">
        <!-- 투표 항목들이 여기에 동적으로 추가 -->
        </div>

    <hr>

    <div id="chart-section">
        <h3>📊 투표 결과 통계</h3>

        <select id="chart-type-selector">
            <option value="bar">막대 그래프</option>
            <option value="pie">원형 그래프</option>
            <option value="doughnut">도넛 그래프</option>
            <option value="radar">레이더 그래프</option>
        </select>

        <div id="chart-wrapper">
            <canvas id="voteChart"></canvas>
        </div>
    </div>


    <script type="module">
        import "./vote_form.js";
        import "./graph.js";  // 그래프 로직 실행
        import "./chartView.js";
        import { initAuth, loadPoll } from "./pollData.js";

        async function main() {
            try {
                await initAuth();
                await loadPoll();
            } catch (error) {
                console.error("초기화 실패:", error);
                document.getElementById("polls").innerText = "오류가 발생했습니다.";
            }
        }
        main();
    </script>
</body>
</html>
